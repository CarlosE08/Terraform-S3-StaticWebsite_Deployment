# Static Website Deployment on AWS S3 with Terraform & GitHub Actions

Este proyecto despliega un sitio web estÃ¡tico en un bucket de Amazon S3 utilizando Terraform para definir la infraestructura y GitHub Actions para automatizar el despliegue de archivos estÃ¡ticos desde la carpeta `/files`.

---

## Arquitectura

- **Amazon S3**: Bucket nuevo o existente configurado como sitio web.
- **ConfiguraciÃ³n de hosting**: Usa `index.html` como documento raÃ­z.
- **PolÃ­tica pÃºblica opcional**: Habilita acceso anÃ³nimo mediante `apply_bucket_policy`.
- **GitHub Actions**: Automatiza el despliegue a S3 al hacer push a `main`.

---

## Estructura del Proyecto

```
.
â”œâ”€â”€ modules/
â”‚   â””â”€â”€ S3/
â”‚       â”œâ”€â”€ aws_s3.tf
â”‚       â”œâ”€â”€ Variables.tf
â”‚       â””â”€â”€ outputs.tf
â”œâ”€â”€ terraform.tfvars
â”œâ”€â”€ main.tf
â”œâ”€â”€ outputs.tf
â”œâ”€â”€ terraform_sync.yml         # Despliegue de infraestructura
â””â”€â”€ s3_deploy.yml           # SincronizaciÃ³n de archivos estÃ¡ticos
```

---

## âš™ï¸ Variables Principales (`terraform.tfvars`)

```hcl
bucket_name         = "mi-sitio-estatico"
use_existing_bucket = false
apply_bucket_policy = true

common_tags = {
  owner      = "Carlos Escobar"
  customer   = "Test"
  project    = "Terraform_testing"
}
```

---

## â–¶ï¸ Instrucciones de Uso

### 1. Inicializa Terraform

```bash
terraform init
```

### 2. Aplica los cambios

```bash
terraform apply -var-file="terraform.tfvars" -auto-approve
```

### 3. Accede al sitio web

DespuÃ©s del `apply`, visita el sitio con:

```
http://<bucket-name>.s3-website-<region>.amazonaws.com
```

> La URL tambiÃ©n se exporta como `output`.

---

## ğŸ¤– AutomatizaciÃ³n con GitHub Actions

### Despliegue de Terraform (`terraform_sync.yml`)

Se ejecuta en cada push a `main` y crea/modifica la infraestructura en AWS.

### SincronizaciÃ³n de archivos (`deploy_to_s3.yml`)

```yaml
on:
  workflow_run:
    workflows: ["Terraform AWS Modular"]
    types:
      - completed

jobs:
  deploy:
    if: >
      github.event.workflow_run.conclusion == 'success' &&
      github.event.workflow_run.head_branch == 'main'
```

Este flujo sube automÃ¡ticamente los contenidos de la carpeta `/files` a S3 si el despliegue Terraform fue exitoso en la rama `main`.

---

## ğŸ” Permisos necesarios (IAM)

El usuario o rol que ejecuta Terraform debe tener permisos para:

- `s3:CreateBucket`
- `s3:PutBucketPolicy`
- `s3:PutBucketWebsite`
- `s3:PutObject`
- `s3:GetObject`
- `s3:PutBucketPublicAccessBlock`

---

## âš ï¸ Consideraciones

- AsegÃºrate de desactivar los bloqueos de acceso pÃºblico si vas a aplicar una polÃ­tica pÃºblica (`apply_bucket_policy = true`).
- En producciÃ³n, es recomendable usar CloudFront para control de acceso y rendimiento.

---

## ğŸ“¤ Outputs

```hcl
output "bucket_id"   = ...
output "bucket_arn"  = ...
output "bucket_name" = ...
output "website_url" = "http://${var.bucket_name}.s3-website-${var.aws_region}.amazonaws.com"
```

---

## ğŸ‘¤ Autor

**Carlos Escobar**  
ğŸ“§ carlosescobar08@proton.me
